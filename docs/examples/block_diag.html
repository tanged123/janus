<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Block Diagonal System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; width: 100%; }
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: #eee; overflow: hidden; display: flex; }
        #controls { position: fixed; top: 10px; left: 10px; z-index: 100; background: rgba(0,0,0,0.8);
                    padding: 12px; border-radius: 8px; }
        #controls button { margin: 2px; padding: 8px 14px; cursor: pointer; border: none;
                           border-radius: 4px; background: #4a4a6a; color: white; font-size: 13px; }
        #controls button:hover { background: #6a6a8a; }
        #container { flex: 1; cursor: grab; overflow: hidden; height: 100%; }
        #container:active { cursor: grabbing; }
        #sidebar { width: 280px; height: 100%; background: #16213e; padding: 16px; overflow-y: auto; 
                   border-left: 2px solid #0f3460; }
        #sidebar h2 { color: #e94560; margin-bottom: 12px; font-size: 16px; }
        #sidebar .section { margin-bottom: 14px; }
        #sidebar .label { color: #888; font-size: 11px; text-transform: uppercase; margin-bottom: 4px; }
        #sidebar .value { background: #0f3460; padding: 10px; border-radius: 6px; font-family: monospace;
                          font-size: 14px; }
        #sidebar .stat { display: flex; justify-content: space-between; padding: 6px 0;
                         border-bottom: 1px solid #0f3460; }
        #sidebar .stat-value { color: #4dc3ff; font-weight: bold; }
        #info { position: fixed; bottom: 10px; left: 10px; background: rgba(0,0,0,0.8);
                padding: 10px; border-radius: 4px; font-size: 12px; }
        .nz { cursor: pointer; }
        .nz:hover { fill: #e94560 !important; }
        .axis-label { font-family: monospace; font-size: 10px; fill: #666; }
        .grid-line { stroke: #ddd; stroke-width: 0.5; }
    </style>
</head>
<body>
    <div id="controls">
        <button onclick="zoomIn()">Zoom +</button>
        <button onclick="zoomOut()">Zoom -</button>
        <button onclick="resetView()">Reset</button>
        <button onclick="fitToScreen()">Fit</button>
    </div>
    <div id="container">
        <svg id="spy" width="166" height="156" style="background:#ffffff;">
            <g id="matrix" transform="translate(50,40)">
                <line class="grid-line" x1="0" y1="0" x2="96" y2="0"/>
                <line class="grid-line" x1="0" y1="12" x2="96" y2="12"/>
                <line class="grid-line" x1="0" y1="24" x2="96" y2="24"/>
                <line class="grid-line" x1="0" y1="36" x2="96" y2="36"/>
                <line class="grid-line" x1="0" y1="48" x2="96" y2="48"/>
                <line class="grid-line" x1="0" y1="60" x2="96" y2="60"/>
                <line class="grid-line" x1="0" y1="72" x2="96" y2="72"/>
                <line class="grid-line" x1="0" y1="84" x2="96" y2="84"/>
                <line class="grid-line" x1="0" y1="96" x2="96" y2="96"/>
                <line class="grid-line" x1="0" y1="0" x2="0" y2="96"/>
                <line class="grid-line" x1="12" y1="0" x2="12" y2="96"/>
                <line class="grid-line" x1="24" y1="0" x2="24" y2="96"/>
                <line class="grid-line" x1="36" y1="0" x2="36" y2="96"/>
                <line class="grid-line" x1="48" y1="0" x2="48" y2="96"/>
                <line class="grid-line" x1="60" y1="0" x2="60" y2="96"/>
                <line class="grid-line" x1="72" y1="0" x2="72" y2="96"/>
                <line class="grid-line" x1="84" y1="0" x2="84" y2="96"/>
                <line class="grid-line" x1="96" y1="0" x2="96" y2="96"/>
                <text class="axis-label" x="-5" y="6" text-anchor="end" dominant-baseline="middle">0</text>
                <text class="axis-label" x="-5" y="18" text-anchor="end" dominant-baseline="middle">1</text>
                <text class="axis-label" x="-5" y="30" text-anchor="end" dominant-baseline="middle">2</text>
                <text class="axis-label" x="-5" y="42" text-anchor="end" dominant-baseline="middle">3</text>
                <text class="axis-label" x="-5" y="54" text-anchor="end" dominant-baseline="middle">4</text>
                <text class="axis-label" x="-5" y="66" text-anchor="end" dominant-baseline="middle">5</text>
                <text class="axis-label" x="-5" y="78" text-anchor="end" dominant-baseline="middle">6</text>
                <text class="axis-label" x="-5" y="90" text-anchor="end" dominant-baseline="middle">7</text>
                <text class="axis-label" x="-5" y="102" text-anchor="end" dominant-baseline="middle">8</text>
                <text class="axis-label" x="6" y="-8" text-anchor="middle">0</text>
                <text class="axis-label" x="18" y="-8" text-anchor="middle">1</text>
                <text class="axis-label" x="30" y="-8" text-anchor="middle">2</text>
                <text class="axis-label" x="42" y="-8" text-anchor="middle">3</text>
                <text class="axis-label" x="54" y="-8" text-anchor="middle">4</text>
                <text class="axis-label" x="66" y="-8" text-anchor="middle">5</text>
                <text class="axis-label" x="78" y="-8" text-anchor="middle">6</text>
                <text class="axis-label" x="90" y="-8" text-anchor="middle">7</text>
                <text class="axis-label" x="102" y="-8" text-anchor="middle">8</text>
                <rect class="nz" x="0" y="0" width="12" height="12" fill="#1e3a5f" data-row="0" data-col="0"/>
                <rect class="nz" x="0" y="12" width="12" height="12" fill="#1e3a5f" data-row="1" data-col="0"/>
                <rect class="nz" x="0" y="24" width="12" height="12" fill="#1e3a5f" data-row="2" data-col="0"/>
                <rect class="nz" x="0" y="36" width="12" height="12" fill="#1e3a5f" data-row="3" data-col="0"/>
                <rect class="nz" x="12" y="0" width="12" height="12" fill="#1e3a5f" data-row="0" data-col="1"/>
                <rect class="nz" x="12" y="12" width="12" height="12" fill="#1e3a5f" data-row="1" data-col="1"/>
                <rect class="nz" x="12" y="24" width="12" height="12" fill="#1e3a5f" data-row="2" data-col="1"/>
                <rect class="nz" x="12" y="36" width="12" height="12" fill="#1e3a5f" data-row="3" data-col="1"/>
                <rect class="nz" x="24" y="0" width="12" height="12" fill="#1e3a5f" data-row="0" data-col="2"/>
                <rect class="nz" x="24" y="12" width="12" height="12" fill="#1e3a5f" data-row="1" data-col="2"/>
                <rect class="nz" x="24" y="24" width="12" height="12" fill="#1e3a5f" data-row="2" data-col="2"/>
                <rect class="nz" x="24" y="36" width="12" height="12" fill="#1e3a5f" data-row="3" data-col="2"/>
                <rect class="nz" x="36" y="0" width="12" height="12" fill="#1e3a5f" data-row="0" data-col="3"/>
                <rect class="nz" x="36" y="12" width="12" height="12" fill="#1e3a5f" data-row="1" data-col="3"/>
                <rect class="nz" x="36" y="24" width="12" height="12" fill="#1e3a5f" data-row="2" data-col="3"/>
                <rect class="nz" x="36" y="36" width="12" height="12" fill="#1e3a5f" data-row="3" data-col="3"/>
                <rect class="nz" x="48" y="48" width="12" height="12" fill="#1e3a5f" data-row="4" data-col="4"/>
                <rect class="nz" x="48" y="60" width="12" height="12" fill="#1e3a5f" data-row="5" data-col="4"/>
                <rect class="nz" x="48" y="72" width="12" height="12" fill="#1e3a5f" data-row="6" data-col="4"/>
                <rect class="nz" x="48" y="84" width="12" height="12" fill="#1e3a5f" data-row="7" data-col="4"/>
                <rect class="nz" x="60" y="48" width="12" height="12" fill="#1e3a5f" data-row="4" data-col="5"/>
                <rect class="nz" x="60" y="60" width="12" height="12" fill="#1e3a5f" data-row="5" data-col="5"/>
                <rect class="nz" x="60" y="72" width="12" height="12" fill="#1e3a5f" data-row="6" data-col="5"/>
                <rect class="nz" x="60" y="84" width="12" height="12" fill="#1e3a5f" data-row="7" data-col="5"/>
                <rect class="nz" x="72" y="48" width="12" height="12" fill="#1e3a5f" data-row="4" data-col="6"/>
                <rect class="nz" x="72" y="60" width="12" height="12" fill="#1e3a5f" data-row="5" data-col="6"/>
                <rect class="nz" x="72" y="72" width="12" height="12" fill="#1e3a5f" data-row="6" data-col="6"/>
                <rect class="nz" x="72" y="84" width="12" height="12" fill="#1e3a5f" data-row="7" data-col="6"/>
                <rect class="nz" x="84" y="48" width="12" height="12" fill="#1e3a5f" data-row="4" data-col="7"/>
                <rect class="nz" x="84" y="60" width="12" height="12" fill="#1e3a5f" data-row="5" data-col="7"/>
                <rect class="nz" x="84" y="72" width="12" height="12" fill="#1e3a5f" data-row="6" data-col="7"/>
                <rect class="nz" x="84" y="84" width="12" height="12" fill="#1e3a5f" data-row="7" data-col="7"/>
            </g>
        </svg>
    </div>
    <div id="sidebar">
        <h2>Sparsity Info</h2>
        <div class="section">
            <div class="stat"><span>Matrix Size</span><span class="stat-value">8 x 8</span></div>
            <div class="stat"><span>Non-zeros</span><span class="stat-value">32</span></div>
            <div class="stat"><span>Density</span><span class="stat-value">50.00%</span></div>
        </div>
        <div class="section">
            <div class="label">Selected Cell</div>
            <div class="value" id="cell-info">Click on a non-zero cell</div>
        </div>
        <div class="section">
            <div class="label">Notation</div>
            <div class="value" id="notation-info">A(row, col)</div>
        </div>
    </div>
    <div id="info">Scroll to zoom - Drag to pan - Click cells for info</div>
    <script>
        let scale = 1, panX = 0, panY = 0, isDragging = false, startX, startY;
        const container = document.getElementById('container');
        const svg = document.getElementById('spy');
        const cellInfo = document.getElementById('cell-info');
        const notationInfo = document.getElementById('notation-info');
        const svgWidth = 166;
        const svgHeight = 156;
        const matrixRows = 8;
        const matrixCols = 8;

        fitToScreen();

        function updateTransform() {
            svg.style.transform = `translate(${panX}px, ${panY}px) scale(${scale})`;
            svg.style.transformOrigin = '0 0';
        }
        function zoomIn() { scale *= 1.3; updateTransform(); }
        function zoomOut() { scale /= 1.3; updateTransform(); }
        function resetView() { scale = 1; panX = 0; panY = 0; updateTransform(); }
        function fitToScreen() {
            const availWidth = window.innerWidth - 280;
            const scaleX = (availWidth - 40) / svgWidth;
            const scaleY = (window.innerHeight - 40) / svgHeight;
            scale = Math.min(scaleX, scaleY);
            panX = (availWidth - svgWidth * scale) / 2;
            panY = (window.innerHeight - svgHeight * scale) / 2;
            updateTransform();
        }
        container.addEventListener('wheel', e => {
            e.preventDefault();
            const rect = container.getBoundingClientRect();
            const mouseX = e.clientX - rect.left, mouseY = e.clientY - rect.top;
            const zoomFactor = e.deltaY < 0 ? 1.15 : 0.87;
            panX = mouseX - (mouseX - panX) * zoomFactor;
            panY = mouseY - (mouseY - panY) * zoomFactor;
            scale *= zoomFactor;
            updateTransform();
        });
        container.addEventListener('mousedown', e => { 
            if (e.target.classList.contains('nz')) return;
            isDragging = true; startX = e.clientX - panX; startY = e.clientY - panY; 
        });
        container.addEventListener('mousemove', e => { if (isDragging) { panX = e.clientX - startX; panY = e.clientY - startY; updateTransform(); } });
        container.addEventListener('mouseup', () => isDragging = false);
        container.addEventListener('mouseleave', () => isDragging = false);

        // Cell interaction
        let selectedCell = null;
        svg.querySelectorAll('.nz').forEach(rect => {
            rect.addEventListener('click', e => {
                e.stopPropagation();
                if (selectedCell) selectedCell.style.stroke = 'none';
                selectedCell = e.target;
                selectedCell.style.stroke = '#e94560';
                selectedCell.style.strokeWidth = '2';
                
                const r = parseInt(e.target.dataset.row);
                const c = parseInt(e.target.dataset.col);
                cellInfo.textContent = `Row: ${r}, Col: ${c}`;
                notationInfo.textContent = `A(${r}, ${c}) = nonzero`;
            });
            rect.addEventListener('mouseenter', e => {
                const r = e.target.dataset.row;
                const c = e.target.dataset.col;
                cellInfo.textContent = `Row: ${r}, Col: ${c}`;
            });
        });
    </script>
</body>
</html>
